<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Login | Aviya Magnus</title>

  <!-- Favicon -->
  <link href="img/favicon.ico" rel="shortcut icon"/>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,500,600,700" rel="stylesheet">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/bootstrap.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
  <link rel="stylesheet" href="css/style.css"/>
</head>

<body>
  <div class="login-container">
    <h2>ðŸŽ“ Student Login</h2>

    <div class="form-group">
      <label for="email">Email:</label>
      <input type="email" id="email" class="form-control" placeholder="Enter your email" required />
    </div>

    <div class="form-group">
      <label for="password">Password:</label>
      <input type="password" id="password" class="form-control" placeholder="Enter your password" required />
    </div>

    <button class="btn btn-primary" onclick="loginAsStudent()">Login as Student</button>
  </div>

  <script>
    async function loginAsStudent() {
      const emailInput = document.getElementById("email");
      const passwordInput = document.getElementById("password");

      if (!emailInput || !passwordInput) {
        alert("Login form elements not found.");
        return;
      }

      const email = emailInput.value.trim();
      const password = passwordInput.value.trim();

      if (!email || !password) {
        alert("Please enter both email and password.");
        return;
      }

      try {
        // ðŸ”— Change this URL to your actual backend Render URL
        const backendURL = "https://aviyamagnus-com.onrender.com/login";

        const response = await fetch(backendURL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password }),
        });

        // If backend doesn't respond properly
        if (!response.ok) {
          alert("Invalid credentials. Please try again.");
          console.error("Login failed:", response.statusText);
          return;
        }

        const data = await response.json();

        // Expecting backend to return { success: true, token: "..." }
        if (data.success) {
          localStorage.setItem("token", data.token);
          alert("Login successful!");
          window.location.href = "student-dashboard.html";
        } else {
          alert(data.message || "Invalid login details.");
        }
      } catch (error) {
        console.error("Login error:", error);
        alert("Something went wrong. Please try again later.");
      }
    }
  </script>
</body>
</html>
